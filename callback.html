<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Autenticando...</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <p>Aguarde, estamos autenticando sua sessão e redirecionando você de volta para a aplicação...</p>

    <script type="text/javascript">
        // Esta função pega os parâmetros 'supabase_url' e 'supabase_key' da URL
        const params = new URLSearchParams(window.location.search);
        const supaUrl = 'https://pmivvwtqllcspjwnxzuc.supabase.co';
        const supaKey = 'sb_publishable_6fhI0XCb34MuNaM0vXwvGw_c-u-6OXq';

        if (supaUrl && supaKey) {
            const supabase = supabase.createClient(supaUrl, supaKey);

            // O Supabase JS automaticamente detecta o token na URL (#) e estabelece a sessão.
            supabase.auth.onAuthStateChange((event, session) => {
                if (event === 'SIGNED_IN') {
                    // Quando o login for confirmado, redireciona para a aplicação principal.
                    window.location.href = 'https://exatos.streamlit.app';
                }
            });
        } else {
            document.body.innerHTML = '<p>Erro: Credenciais do Supabase não encontradas na URL.</p>';
        }
    </script>
</body>
</html>
